<!DOCTYPE html>
<html>
  <body>
    <h1>CORS Exploit Test</h1>
    <script>
      const targetUrl = prompt("Enter the URL you want to test (must include full path, e.g. https://site.com/protected):");

      if (targetUrl) {
        fetch(targetUrl, {
          credentials: "include"
        })
        .then(response => response.text())
        .then(data => {
          console.log("RESPONSE:", data);
          document.body.innerHTML += `<h2>Response from: ${targetUrl}</h2><pre>${escapeHtml(data)}</pre>`;
        })
        .catch(error => {
          console.error("Error:", error);
          document.body.innerHTML += `<p style="color:red;">Fetch error: ${error}</p>`;
        });
      } else {
        document.body.innerHTML += `<p style="color:orange;">No URL entered.</p>`;
      }

      // Helper function to escape HTML
      function escapeHtml(str) {
        return str
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;")
          .replace(/"/g, "&quot;")
          .replace(/'/g, "&#039;");
      }
    </script>
  </body>
</html>
